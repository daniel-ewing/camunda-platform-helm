version: '3'

env:
  TEST_NAMESPACE: '{{ env "TEST_NAMESPACE" | default "camunda-platform" }}'
  CLIENT_SECRET: '{{ env "RANDOM" | sha1sum }}'

# TODO: Rethink about this and find out a better approach.
tasks:
  default:
    cmds:
    # Add Keycloak client secret for Helm deployment.
    - kubectl create secret generic integration-venom-core
        --namespace $TEST_NAMESPACE
        --from-literal "client-secret=$CLIENT_SECRET"
    # Add Keycloak client secret for testsuites.
    - echo "client-secret=$CLIENT_SECRET" > ../../testsuites/base/files/secrets.env
